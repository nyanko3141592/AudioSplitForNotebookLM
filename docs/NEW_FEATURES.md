# 新機能ガイド v2.2

## 🎯 概要

爆速議事録 v2.2では、ユーザビリティの向上と効率化を目的とした重要な新機能を追加しました。このガイドでは、これらの新機能の使い方を詳しく説明します。

## ✨ 新機能一覧

### 🏷️ 自動タイトル生成
### 📅 日付セクション表示  
### 🎛️ タイル・リスト表示切り替え
### 💾 設定の永続化
### ⏰ 時間表示強化
### 🔄 リカバリー機能（開発中）

---

## 🏷️ 自動タイトル生成機能

### 📋 機能概要
要約生成完了時に、Gemini APIが要約内容を解析して自動的に簡潔なタイトルを生成します。

### 🎯 メリット
- **時短**: 手動でのタイトル考案が不要
- **一貫性**: AIによる客観的で統一されたタイトル形式
- **検索性**: 内容を的確に表現したタイトルで履歴検索が効率化

### 🔧 使用方法

#### 基本フロー
1. 通常通り要約処理を実行
2. 要約完了後、進捗表示が「タイトルを生成しています...」に変更
3. 自動生成されたタイトルが要約履歴に保存される

```typescript
// 生成されるタイトルの例
"新商品戦略会議" (元ファイル: meeting_20241201.mp3)
"四半期売上レビュー" (元ファイル: sales_review.wav)  
"チーム定例MTG" (元ファイル: team_weekly.m4a)
```

#### タイトル仕様
- **長さ制限**: 20文字以内
- **形式**: 日本語での簡潔な表現
- **内容**: 要約の主要トピックを反映
- **フォールバック**: 生成失敗時は元ファイル名を使用

### ⚙️ カスタマイズ

#### 手動編集機能
自動生成されたタイトルは後から編集可能:

1. 要約履歴でタイトル横の✏️アイコンをクリック
2. 編集フィールドが表示される
3. **Ctrl+Enter**で確定、**Escape**でキャンセル

#### プロンプト例
```
入力要約:
「本日の会議では新商品の価格設定について議論しました。
競合分析の結果、当初予定より10%程度価格を下げることで
市場シェアの拡大を狙う方針で合意しました。」

→ 生成タイトル: "新商品価格戦略会議"
```

---

## 📅 日付セクション表示機能

### 📋 機能概要  
大量の要約履歴を日付別にグループ分けして表示し、時系列での管理を向上させます。

### 🎯 メリット
- **整理**: 日付による自動グループ化
- **視認性**: セクションヘッダーで構造化表示
- **検索性**: 期間別の要約検索が容易

### 🔧 表示ルール

#### グループ化ロジック
```typescript
const groupingLogic = {
  "今日": "本日作成された要約",
  "昨日": "前日作成された要約", 
  "2024年12月1日": "それ以前の具体的な日付"
};
```

#### UI表示例
```
📋 要約履歴
┌─────────────────┐
│ 今日            │ ← セクションヘッダー
├─────────────────┤
│ [14:30] 定例MTG  │
│ [09:15] 企画会議 │
├─────────────────┤
│ 昨日            │
├─────────────────┤  
│ [16:45] 売上確認 │
│ [11:00] 進捗報告 │
└─────────────────┘
```

### ⚙️ 技術詳細

#### 日付計算
```javascript
const getDateGroup = (timestamp) => {
  const itemDate = new Date(timestamp);
  const today = new Date();
  const yesterday = new Date(today);
  yesterday.setDate(yesterday.getDate() - 1);
  
  if (isSameDay(itemDate, today)) return "今日";
  if (isSameDay(itemDate, yesterday)) return "昨日";
  return itemDate.toLocaleDateString('ja-JP', {
    year: 'numeric',
    month: 'long', 
    day: 'numeric'
  });
};
```

---

## 🎛️ タイル・リスト表示切り替え機能

### 📋 機能概要
要約履歴の表示方法を「リスト表示」と「タイル表示」で切り替え可能。大量履歴の効率的な管理をサポートします。

### 🎯 使い分け

#### リスト表示（デフォルト）
- **適用場面**: 詳細情報を重視する場合
- **特徴**: 縦一列での詳細表示
- **表示内容**: 完全な要約プレビュー、メタデータ

#### タイル表示  
- **適用場面**: 大量履歴の一覧性重視
- **特徴**: 3カラムのグリッドレイアウト  
- **表示内容**: コンパクトな要約プレビュー

### 🔧 操作方法

#### 切り替えボタン
要約履歴ページのヘッダーに配置:
```
[📋] [⊞] 設定 エクスポート すべて削除
 ↑    ↑
リスト タイル
```

#### レスポンシブ対応
```css
/* タイル表示のレスポンシブ */
.tile-grid {
  grid-template-columns: 1fr;        /* スマートフォン: 1列 */
  grid-template-columns: 1fr 1fr;    /* タブレット: 2列 */  
  grid-template-columns: repeat(3, 1fr); /* PC: 3列 */
}
```

### 📱 表示比較

#### リスト表示の特徴
```
┌─────────────────────────────────────────┐
│ [12/01 14:30] 📄 新商品戦略会議        │
│ 本日の会議では新商品の価格設定について... │
│ 📊 15分 🎤 3人 💬 ja                  │
│                              [👁] [🗑] │
└─────────────────────────────────────────┘
```

#### タイル表示の特徴  
```
┌─────────┐ ┌─────────┐ ┌─────────┐
│📄 新商品 │ │📄 進捗  │ │📄 売上  │
│戦略会議  │ │報告MTG │ │レビュー │  
│         │ │        │ │        │
│価格設定に│ │今週の進│ │Q4実績に│
│ついて... │ │捗につい│ │ついて...│
│14:30 15分│ │11:00 30分│ │16:45 45分│
└─────────┘ └─────────┘ └─────────┘
```

---

## 💾 設定の永続化機能

### 📋 機能概要
ユーザーの表示設定（タイル/リスト）をローカルストレージに保存し、次回起動時に復元します。

### 🎯 メリット  
- **継続性**: 毎回の設定変更が不要
- **個人化**: ユーザーの好みを記憶
- **効率性**: ワークフロー中断の最小化

### 🔧 技術実装

#### ストレージ構造
```javascript
// LocalStorage保存形式
const viewSettings = {
  viewMode: 'tile' | 'list',
  timestamp: Date.now(),
  version: '2.2'
};

localStorage.setItem('summaryHistory.viewSettings', JSON.stringify(viewSettings));
```

#### 復元ロジック
```typescript  
const usePersistedViewMode = () => {
  const [viewMode, setViewMode] = useState(() => {
    try {
      const saved = localStorage.getItem('summaryHistory.viewSettings');
      return saved ? JSON.parse(saved).viewMode : 'list';
    } catch {
      return 'list'; // フォールバック
    }
  });
  
  const updateViewMode = (newMode) => {
    setViewMode(newMode);
    saveViewSettings({ viewMode: newMode });
  };
  
  return [viewMode, updateViewMode];
};
```

### ⚙️ エラーハンドリング

#### 設定読み込み失敗時
```javascript
// 安全な設定読み込み
const getViewSettings = () => {
  try {
    const saved = localStorage.getItem('summaryHistory.viewSettings');
    return saved ? JSON.parse(saved) : { viewMode: 'list' };
  } catch (error) {
    console.warn('Failed to load view settings:', error);
    return { viewMode: 'list' }; // デフォルトにフォールバック
  }
};
```

---

## ⏰ 時間表示強化機能

### 📋 機能概要
要約履歴の日付プレフィックス表示に時間情報を追加し、より詳細な時系列管理を可能にします。

### 🎯 改善点
- **Before**: `[12/01] 新商品戦略会議`
- **After**: `[12/01 14:30] 新商品戦略会議`

### 🔧 表示仕様

#### 時刻フォーマット
```javascript
const formatDateShort = (timestamp) => {
  return new Date(timestamp).toLocaleString('ja-JP', {
    month: '2-digit',    // 12
    day: '2-digit',      // 01  
    hour: '2-digit',     // 14
    minute: '2-digit'    // 30
  });
};

// 出力例: "12/01 14:30"
```

#### 使用場面
- **リスト表示**: タイトルプレフィックス
- **タイル表示**: カード下部の時刻情報
- **詳細モーダル**: 作成日時の詳細表示

---

## 🔄 リカバリー機能（開発中）

### 📋 機能概要
> ⚠️ **注意**: この機能は現在開発中で、一時的に無効化されています。

処理中断時の状態復元機能。ブラウザのリロード・クラッシュ時にも作業を継続できます。

### 🎯 将来の計画
- **自動保存**: 各ステップでの進捗状態保存
- **復元ダイアログ**: 中断時の復元オプション表示  
- **データ継承**: APIキー・設定・一時ファイルの復元

### 🔧 実装予定機能
```typescript
interface RecoveryState {
  timestamp: number;
  currentStep: string;
  selectedFile?: FileInfo;
  transcriptionResults?: TranscriptionResult[];
  summarySettings?: SummarySettings;
}
```

---

## 🔧 使用のベストプラクティス

### 📊 効率的な履歴管理

#### タイル表示の活用場面
```markdown
✅ 推奨:
- 日々多数の要約を作成する場合
- 過去の要約を素早く探したい場合  
- 画面領域を最大活用したい場合
- 視覚的な一覧性を重視する場合

❌ 不向き:
- 要約内容を詳細に確認したい場合
- メタデータを重視する場合
- 編集作業を頻繁に行う場合
```

#### 日付セクション活用
```markdown  
効率的な検索方法:
1. まず日付セクションで大まかな期間を絞り込み
2. タイル表示で視覚的に概要をスキャン
3. 対象を特定してリスト表示で詳細確認
4. 必要に応じて詳細モーダルで全内容を確認
```

### 🎯 自動タイトルの活用

#### 生成精度を上げる方法
```markdown
より良いタイトル生成のコツ:
✅ 背景情報を詳細に入力
✅ 会議のアジェンダを明記  
✅ 参加者・プロジェクト名を記載
✅ 具体的な議論内容を含む要約を生成

例: 
背景情報: "2024年12月新商品プロジェクト定例会議、参加者：田中、佐藤、議題：価格設定"
→ 期待されるタイトル: "新商品価格設定会議"
```

### ⚙️ 設定の最適化

#### 推奨設定パターン
```json
// 個人利用パターン
{
  "viewMode": "tile",
  "historyLimit": 50,
  "autoTitle": true
}

// チーム共用パターン  
{
  "viewMode": "list",
  "historyLimit": 100,
  "autoTitle": true
}
```

## 🆘 トラブルシューティング

### よくある問題と解決方法

#### Q: 自動タイトル生成が失敗する
```markdown
A: 以下を確認してください:
1. APIキーが正しく設定されているか
2. インターネット接続が安定しているか  
3. API使用量がクォータ内か
4. 要約内容が適切に生成されているか

フォールバック: 失敗時は元ファイル名が使用されます
```

#### Q: タイル表示が崩れる  
```markdown
A: ブラウザとレスポンシブの問題:
1. ブラウザの表示倍率を100%に設定
2. ウィンドウサイズを適切に調整
3. ブラウザのキャッシュをクリア
4. 最新のブラウザバージョンにアップデート
```

#### Q: 設定が保存されない
```markdown
A: LocalStorageの問題:
1. プライベートモード・シークレットモードでないか確認
2. ブラウザの容量制限に達していないか確認  
3. 他のタブで同じアプリが開かれていないか確認
4. ブラウザのStorageアクセス許可を確認
```

## 📈 パフォーマンス最適化

### 大量履歴での推奨設定
```markdown
履歴が100件以上の場合:
1. タイル表示を優先使用
2. 履歴制限を適切に設定（100件程度）
3. 定期的な履歴整理・エクスポート
4. 不要な履歴の一括削除
```

### メモリ使用量の最適化
```markdown  
ブラウザメモリ効率化:
1. 他の不要なタブを閉じる
2. 大量履歴表示時は他のアプリを終了  
3. 定期的なブラウザ再起動
4. キャッシュクリアの実行
```

---

*最終更新: 2024年12月*  
*このガイドは爆速議事録 v2.2 の新機能について説明しています*